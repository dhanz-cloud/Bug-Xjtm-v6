<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome Back</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet"> 
    
    <style>
        
        /* Mendefinisikan warna utama untuk loading screen */
        :root {
            /* Warna ungu/magenta dari gambar Raiden Shogun (DIPERBAIKI: #FFF0000 -> #FF0000 untuk merah) */
            --loading-primary-color: #00FFFF; 
            --loading-secondary-color: #ffffff;
            --loading-glow-color: #00FFFF; /* Diubah agar lebih kontras */
        }
        
        /* ================================================= */
        /* üö® GAYA LOADING SCREEN BARU (MIMIC FOTO + VIDEO) üö® */
        /* ================================================= */
        .loading-screen {
            display: none; 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000; /* Hitam pekat sesuai foto */
            z-index: 9999; 
            justify-content: center;
            align-items: center;
            flex-direction: column;
            overflow: hidden;
            text-align: center;
        }
        
        /* Kontainer untuk menyesuaikan ukuran video agar mirip foto */
        .video-frame {
            /* Batasan ukuran yang mirip dengan bingkai di foto */
            width: 90%;
            max-width: 450px; 
            /* Rasio aspek agar terlihat seperti kartu */
            aspect-ratio: 16 / 9; 
            
            position: relative;
            margin-bottom: 70px; /* Jarak antara video dan teks "Xjtm-Crasher" */
            border-radius: 20px; /* Sudut melengkung */
            overflow: hidden;

            /* Efek Cahaya biru */
            box-shadow: 0 0 40px rgba(1, 128, 255, 0.8), 0 0 15px rgba(255, 255, 255, 0.5);
            border: 2px solid var(--loading-primary-color);
        }

        /* Gaya untuk Video Loading */
        #loadingVideoPlayer {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Memastikan video mengisi seluruh bingkai */
            display: block;
        }

        /* Teks "Xjtm-Crasher" di bawah video */
        .Xjtm-Crasher-text {
            position: absolute; /* Posisikan relatif terhadap body/screen */
            bottom: 25%; /* Posisikan di bawah bingkai foto */
            font-size: 2.5em; 
            color: var(--loading-secondary-color);
            letter-spacing: 2px;
            font-family: 'Arial', sans-serif; /* Menggunakan font bersih */
            font-weight: bold;
            
            /* Efek Glow Ungu/Magenta */
            text-shadow: 0 0 10px var(--loading-glow-color), 0 0 20px rgba(255, 255, 255, 0.5);
        }


        /* ================================================= */
        /* GAYA YANG SUDAH ADA (Lainnya) - Dibiarkan Sama */
        /* ================================================= */
        
        .video-top {
            position: relative;
            z-index: 100; 
            width: 95%; 
            max-width: 3000px; 
            height: auto; 
            margin-bottom: 25px; 
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0, 255, 255, 1.2), 0 0 15px rgba(0, 255, 255, 0.7);
            border: 3px solid #00FFFF;
            background-color: #000;
        }

        .video-top video {
            display: block;
            width: 102%;
            height: auto;
            object-fit: cover;
            opacity: 0.95; 
        }

        body {
            background-image: url('https://files.catbox.moe/1unink.jpg'); 
            background-color: #000000;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;

            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            position: relative;
            color: #ffffff;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); 
            z-index: 1;
        }

        .login-container {
            position: relative;
            z-index: 2;
            background-color: rgba(5, 5, 5, 0.95); 
            padding: 18px;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.8); 
            width: 90%;
            max-width: 350px;
            text-align: center;
            border: 3px solid #00FFFF;
        }
        
        /* ================================================= */
        /* GAYA BARU UNTUK KOTAK JUDUL "WELCOME BACK" */
        /* ================================================= */
        .title-box {
            /* Gaya Teks */
            font-family: 'Press Start 2P', cursive;
            color: #00FFFF;
            text-shadow: 0 0 15px rgba(0, 255, 255, 1);
            font-size: 1.5em; 
            animation: flicker 2s infinite alternate;
            text-align: center;
            
            /* Gaya Kotak (meniru input) */
            display: inline-block; 
            padding: 15px 25px;
            
            border: 3px solid #00FFFF; 
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.8), inset 0 0 5px rgba(0, 255, 255, 0.5); 
            background-color: rgba(0, 0, 0, 0.8); 

            /* Margin */
            margin-top: 0;
            margin-bottom: 30px; 
        }

        /* Hapus atau modifikasi gaya H2 lama yang bertabrakan */
        h2 {
            /* Pastikan elemen h2 lain di halaman jika ada, tidak terpengaruh */
            margin-bottom: 0; /* Hapus margin agar .title-box yang mengaturnya */
        }
        
        @keyframes flicker {
            0% { opacity: 1; }
            5% { opacity: 0.9; }
            6% { opacity: 1; }
            7% { opacity: 0.95; }
            10% { opacity: 1; }
        }

        .input-group {
            margin-bottom: 15px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-family: 'VT323', monospace;
            color: #00FFFF;
            font-size: 1.2em;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
        }

        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 15px;
            border: 5px solid #00FFFF; 
            background-color: #000000;
            color: #0FFF;
            border-radius: 10px;
            box-sizing: border-box;
            font-size: 1.1em;
            font-family: 'VT323', monospace;
            box-shadow: inset 0 0 5px rgba(0, 255, 255, 0.5);
        }
        
        input::placeholder {
            color: rgba(0, 255, 255, 0.5);
            font-family: 'VT323', monospace;
            text-transform: uppercase;
        }
        
        input[type="text"]:focus, input[type="password"]:focus {
            outline: none;
            border-color: #00FF;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.8), inset 0 0 5px rgba(0, 255, 255, 0.5);
        }

        .login-button {
            width: 100%;
            padding: 15px;
            border: none;
            background-color: #00FFFF; 
            color: #000000; 
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 0 0 15px rgba(0, 255, 255, 1);
            font-family: 'Press Start 2P', cursive;
            transition: all 0.2s ease-in-out;
        }

        .login-button:hover {
            background-color: #00BFFF; 
            box-shadow: 0 0 25px rgba(0, 255, 255, 1.5);
            transform: scale(1.02);
        }

        .buy-button {
            display: block; 
            width: 100%;
            padding: 10px;
            margin-top: 20px; 
            border: 2px solid #00FFFF; 
            background-color: #0F0F0F;
            color: #ffffff; 
            font-size: 0.5em;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 0 0 15px rgba(0, 155, 0, 5);
            font-family: 'Press Start 2P', cursive;
            text-decoration: none; 
            box-sizing: border-box; 
            text-align: center; 
            transition: all 0.2s ease-in-out;
        }
        
        .buy-button:hover {
            background-color: #0FFF000; 
            box-shadow: 0 0 25px rgba(0, 255, 0, 1.5);
            transform: scale(1.02);
        }

        /* Modal Kustom untuk Error (Dibiarkan sama) */
        .error-modal {
            display: none; 
            position: fixed;
            z-index: 10; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.85); 
            justify-content: center;
            align-items: center;
        }

        .error-content {
            background-color: #1a1a1a;
            padding: 30px;
            border: 2px solid #FF0000; 
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
            width: 80%;
            max-width: 300px;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }

        .error-message {
            color: #FF4500; 
            font-size: 0.9em;
            font-family: 'Press Start 2P', cursive;
            white-space: pre-line; 
            line-height: 1.4;
            margin-bottom: 20px;
        }
        
        .error-close-button {
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            font-family: 'VT323', monospace;
            border: 1px solid #FF4500;
            background-color: #FF0000;
            color: white;
            box-shadow: 0 0 5px rgba(255, 0, 0, 0.7);
        }
        
    </style>
</head>
<body>

    <div id="loadingScreen" class="loading-screen">
        
        <div class="video-frame">
            <video id="loadingVideoPlayer" 
                   src="https://files.catbox.moe/u41oyu.mp4" 
                   autoplay 
                   muted 
                   playsinline>
            </video>
        </div>
        
        <div class="Xjtm-Crasher-text">Xjtm-Crasher</div>
    </div>
    <div id="errorModal" class="error-modal">
        <div class="error-content">
            <div id="errorText" class="error-message"></div>
            <button id="errorCloseButton" class="error-close-button">TUTUP</button>
        </div>
    </div>

    <audio id="backgroundMusic" loop>
        <source src="https://files.catbox.moe/0fexsl.mp4" type="audio/mp4">
    </audio>
    <div class="video-top">
        <video id="loginVideo" src="https://files.catbox.moe/u41oyu.mp4" muted loop autoplay playsinline></video>
    </div>

    <div class="login-container">
        <h2 class="title-box">Welcome Back</h2>
        <form id="loginForm">
            <div class="input-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" placeholder="MASUKKAN USERNAME" required>
            </div>
            <div class="input-group">
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" placeholder="MASUKKAN PASSWORD" required>
            </div>
            <button type="submit" class="login-button">LOGIN</button>
        </form>
        
        <a href="buy_account.html" class="buy-button">Buy Account</a>

    </div>

    <script>
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const errorModal = document.getElementById('errorModal');
        const errorText = document.getElementById('errorText');
        const errorCloseButton = document.getElementById('errorCloseButton');
        const videoElement = document.getElementById('loginVideo');
        const musicElement = document.getElementById('backgroundMusic');
        
        // ELEMENT LOADING
        const loadingScreen = document.getElementById('loadingScreen');
        const loadingVideoPlayer = document.getElementById('loadingVideoPlayer');


        // --- 1. Logika Modal Kustom ---
        errorCloseButton.onclick = function() {
            errorModal.style.display = 'none';
        }

        // --- 2. Autoplay Media ---
        function attemptAutoplayMedia() {
            if (videoElement) {
                videoElement.play().catch(error => {
                    document.body.addEventListener('click', () => { videoElement.play(); }, { once: true });
                });
            }
            if (musicElement) {
                musicElement.play().catch(error => {
                    document.body.addEventListener('click', () => { musicElement.play(); }, { once: true });
                });
            }
        }
        document.addEventListener('DOMContentLoaded', attemptAutoplayMedia);


        // --- 3. Pengecekan Expired Date ---
        function isExpired(expiryDateString) {
            if (!expiryDateString) return false;

            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const expiry = new Date(expiryDateString);
            expiry.setHours(0, 0, 0, 0);

            return expiry.getTime() <= today.getTime();
        }

        // FUNGSI UTAMA LOGIKA LOGIN (Dengan Perbaikan Logika Loading Screen)
        function handleLogin(event) {
            event.preventDefault();
            
            const enteredUsername = usernameInput.value.trim();
            const enteredPassword = passwordInput.value.trim();
            
            const HARDCODED_ACCOUNTS = [
                { username: "dhanz", password: "dev", role: "developer" },
                { username: "owner", password: "own", role: "owner" },
                { username: "reseller_utama", password: "res", role: "reseller" }
            ];
            
            const memberAccounts = JSON.parse(localStorage.getItem('memberAccounts')) || [];
            const ALL_ACCOUNTS = HARDCODED_ACCOUNTS.concat(memberAccounts);
            
            const ADMIN_BUG_PAGE = "dashboard.html";
            const DASHBOARD_PAGE = "dashboard.html";

            if (enteredUsername === "" || enteredPassword === "") {
                errorText.textContent = "Username and password are required.";
                errorModal.style.display = 'flex';
                return; // Hentikan fungsi jika input kosong
            }
            
            const foundAccount = ALL_ACCOUNTS.find(acc => 
                acc.username === enteredUsername && acc.password === enteredPassword
            );

            if (foundAccount) {
                
                // 1. Cek Expired
                if (foundAccount.expiry && isExpired(foundAccount.expiry)) {
                    errorText.textContent = `‚ùå AKUN EXPIRED!\\nSilakan perpanjang durasi akun Anda.\\n(Expired: ${new Date(foundAccount.expiry).toLocaleDateString()})`;
                    errorModal.style.display = 'flex';
                    return; // Hentikan jika expired
                }
                
                // 2. JIKA BERHASIL & TIDAK EXPIRED: TAMPILKAN LOADING SCREEN dan PUTAR VIDEO
                loadingScreen.style.display = 'flex';
                loadingVideoPlayer.currentTime = 0;
                loadingVideoPlayer.play();

                // 3. Pindah halaman setelah video selesai diputar
                loadingVideoPlayer.onended = function() {
                    // Login Berhasil
                    localStorage.setItem('userRole', foundAccount.role);
                    
                    // Pindah halaman
                    if (foundAccount.role === 'developer' || foundAccount.role === 'owner' || foundAccount.role === 'reseller') {
                        window.location.href = ADMIN_BUG_PAGE;
                    } else {
                        window.location.href = DASHBOARD_PAGE;
                    }
                    // Hapus listener agar tidak dieksekusi lagi
                    loadingVideoPlayer.onended = null;
                };
            } else {
                // Login Gagal
                errorText.textContent = "USERNAME SAMA PASWORD SALAH DONGO TOLOL GOBLOK BEBAN KELUARGA PENGANGGURAN (MISKIN), BERHARAP FREE üòπüòπüòπ";
                errorModal.style.display = 'flex';
                // Loading screen tidak ditampilkan karena belum diaktifkan
            }
        }
        
        document.getElementById('loginForm').addEventListener('submit', handleLogin);
    </script>
    
</body>
</html>